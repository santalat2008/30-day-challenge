t = int(input())
for _ in range(t):
    n = int(input())
    a = list(map(int, input().split()))
    
    idx = [(a[i], i + 1) for i in range(n)]
    idx.sort(reverse=True)

    x = [0] * (n + 1)
    p = 1
    d = 1
    res = 0

    for v, i in idx:
        x[i] = d * p
        res += 2 * p * v
        d *= -1
        if d == 1:
            p += 1

    print(res)
    print(*x)
